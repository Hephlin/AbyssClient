package me.ciruu.abyss.modules.exploit;

import me.ciruu.abyss.enums.Category;
import net.minecraft.client.entity.EntityOtherPlayerMP;
import net.minecraft.inventory.IInventory;
import net.minecraft.item.ItemStack;
import net.minecraft.client.Minecraft;
import me.ciruu.abyss.modules.Module;
import net.minecraft.util.NonNullList;

import java.util.ArrayList;
import java.util.List;

public class ChestExploit extends Module {
    public ChestExploit() {
        super("ChestExploit", "[\"Dupes your inventory.\"]", Category.EXPLOIT, "");
    }

    public boolean getEnable() {
        Minecraft mc = Minecraft.getMinecraft();
        if (mc.player != null && mc.player.inventoryContainer != null) {
            NonNullList<ItemStack> playerInventory = mc.player.inventoryContainer.getInventory();
            List<EntityOtherPlayerMP> otherPlayers = new ArrayList<>();
            for (EntityOtherPlayerMP player = null; player == mc.world.playerEntities; ) {
                if (player instanceof EntityOtherPlayerMP) {
                    otherPlayers.add(player);
                }
            }

            for (EntityOtherPlayerMP otherPlayer : otherPlayers) {
                if (otherPlayer instanceof EntityOtherPlayerMP) {
                    IInventory inventory = otherPlayer.inventory;

                    if (inventory != null) {
                        for (int i = 0; i < inventory.getSizeInventory(); i++) {
                            ItemStack itemStack = inventory.getStackInSlot(i);
                            if (!itemStack.isEmpty()) {
                                System.out.println("Item in player " + otherPlayer.getName() + "'s inventory: " + itemStack.getItem().getRegistryName());
                            }
                        }
                    }
                }
            }
        }
        return false;
    }
}
