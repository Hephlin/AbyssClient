package me.ciruu.abyss.modules.exploit;

import java.util.function.Predicate;
import me.ciruu.abyss.Globals;
import me.ciruu.abyss.Manager;
import me.ciruu.abyss.enums.Category;
import me.ciruu.abyss.events.network.EventNetworkPostPacketEvent;
import me.ciruu.abyss.modules.Module;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.entity.passive.AbstractChestHorse;
import net.minecraft.network.play.client.CPacketUseEntity;

public class MountBypass
extends Module {
    private boolean Field366;
    @EventHandler
    private final Listener Field367 = new Listener<EventNetworkPostPacketEvent>(this::Method458, new Predicate[0]);

    public MountBypass() {
        super("MountBypass", "", Category.EXPLOIT, "");
    }

    public boolean getEnable() {
        super.getEnable();
        return false;
    }
    private boolean Method459() {
        if (Manager.moduleManager.isModuleEnabled(AutoMountDupe.class)) {
            return !((AutoMountDupe)Manager.moduleManager.getModuleByClass(AutoMountDupe.class)).Method460();
        }
        return true;
    }

    private void Method458(EventNetworkPostPacketEvent eventNetworkPostPacketEvent) {
        if (eventNetworkPostPacketEvent.getPacket() instanceof CPacketUseEntity && this.Method459()) {
            CPacketUseEntity cPacketUseEntity = (CPacketUseEntity)eventNetworkPostPacketEvent.getPacket();
            if (cPacketUseEntity.getEntityFromWorld(Globals.mc.world) instanceof AbstractChestHorse && cPacketUseEntity.getAction() == CPacketUseEntity.Action.INTERACT_AT) {
                eventNetworkPostPacketEvent.cancel();
            }
        }
    }

}
